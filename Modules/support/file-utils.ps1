Get-ChildItem -Directory | Select-Object Name,LastWriteTime,@{Name="Length";Expression={$size = ($_ | gci -Recurse -File | Measure-Object -Sum -Property Length).Sum; $size}} | Sort-Object -Property length | Format-Table Name,@{Label="Length";Expression={($_.length -gt 1GB) ? ("{0,3:N0} GB" -f ($_.length / 1GB)) : ($_.length -gt 1MB) ? ("{0,3:N0} MB" -f ($_.length / 1MB)) : ("{0,3:N0} KB" -f ($_.length / 1KB)) }} -AutoSize
Get-ChildItem zip,exe,image | Select-Object @{Name="Folder";Expression={$_.DirectoryName|Split-Path -Leaf}},Name,Length | Sort-Object Length | Format-Table Folder,Name,@{Name="Size";Expression={datasize($_.Length)}}
function datasize ($size) { ($size -gt 1GB) ? ("{0,3:N0} GB" -f ($size / 1GB)) : ($size -gt 1MB) ? ("{0,3:N0} MB" -f ($size / 1MB)) : ("{0,3:N0} KB" -f ($size / 1KB)) }
