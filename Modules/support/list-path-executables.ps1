[System.Environment]::GetEnvironmentVariable('PATH', [System.EnvironmentVariableTarget]::Process).split(';').Where({  -ne " }) | ? { Test-Path  } | % { [System.IO.Path]::EndsInDirectorySeparator() ? [System.IO.Path]::TrimEndingDirectorySeparator() :  } | Remove-Duplicates | rargs fd --maxdepth 1 --search-path '{0}' | Get-Item | ? -not PSIsContainer | ? { param([System.IO.FileInfo] = ) Get-Command .FullName | ? { param([System.Management.Automation.CommandInfo] = ) .CommandType -Like 'Application' ? .Extension -in '.exe','.cmd' : .CommandType -Like 'ExternalScript' } }
